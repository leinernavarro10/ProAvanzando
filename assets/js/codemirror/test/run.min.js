#!/usr/bin/env node
var lint=require("./lint/lint");lint.checkDir("mode"),lint.checkDir("lib"),lint.checkDir("addon"),lint.checkDir("keymap");var ok=lint.success(),files=new(require("node-static").Server),server=require("http").createServer(function(e,r){e.addListener("end",function(){files.serve(e,r,function(e){e&&(console.error(e),process.exit(1))})}).resume()}).addListener("error",function(e){throw e}).listen(3e3,function(){var e=require("child_process"),r=require("phantomjs"),i=[require("path").join(__dirname,"phantom_driver.js")];e.execFile(r.path,i,function(e,r,i){server.close(),console.log(r),e&&console.error(e),i&&console.error(i),process.exit(e||i||!ok?1:0)})});