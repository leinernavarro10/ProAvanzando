!function(){function t(t,n,e){for(;;){var r=t.indexOf(e,n);if(-1==r)return null;if(t.charAt(r+1)!=e)return r;n=r+2}}function n(n){for(var e=[],r="",l=0;l<n.length;++l){l&&(r+="\n");for(var a=n[l],i=0;i<a.length;){var o,u=null;if("["==a.charAt(i)&&"["!=a.charAt(i+1)){s.lastIndex=i+1;var c=i+(u=s.exec(a)[0].replace(/&/g," ")).length+2;if(null==(f=t(a,c,"]")))throw new Error("Unterminated token at "+i+" in '"+a+"'"+u);o=a.slice(c,f),i=f+1}else{var f=t(a,i,"[");null==f&&(f=a.length),o=a.slice(i,f),i=f}o=o.replace(/\[\[|\]\]/g,function(t){return t.charAt(0)}),e.push(u,o),r+=o}}return{tokens:e,plain:r}}function e(t){return t.replace("&","&amp;").replace("<","&lt;")}function r(t,n,r){for(var s=[],o=0;o<n.length;o+=2){var u=n[o];u&&u.indexOf(" ")&&(u=u.split(" ").sort().join(" ")),s.push(u,n[o+1])}var c=l(t,r),f="",d=a(s,c);if(null!=d&&(f+='<div class="mt-test mt-fail">',f+="<pre>"+e(t)+"</pre>",f+='<div class="cm-s-default">',f+="expected:",f+=i(s,d),f+="observed:",f+=i(c,d),f+="</div>",f+="</div>"),c.indentFailures)for(o=0;o<c.indentFailures.length;o++)f+="<div class='mt-test mt-fail'>"+e(c.indentFailures[o])+"</div>";if(f)throw new Failure(f)}function l(t,n){for(var e=n.startState(),r=t.replace(/\r\n/g,"\n").split("\n"),l=[],a=0,i=0;i<r.length;++i){var s=r[i],o=!0;if(n.indent){var u=s.match(/^\s*/)[0],c=n.indent(e,s.slice(u.length));c!=CodeMirror.Pass&&c!=u.length&&(l.indentFailures||(l.indentFailures=[])).push("Indentation of line "+(i+1)+" is "+c+" (expected "+u.length+")")}var f=new CodeMirror.StringStream(s);for(""==s&&n.blankLine&&n.blankLine(e);!f.eol();){var d=n.token(f,e),h=f.current();if(d&&d.indexOf(" ")>-1&&(d=d.split(" ").sort().join(" ")),f.start=f.pos,a&&l[a-2]==d&&!o?l[a-1]+=h:h&&(l[a++]=d,l[a++]=h),f.pos>5e3){l[a++]=null,l[a++]=this.text.slice(f.pos);break}o=!1}}return l}function a(t,n){for(var e=Math.min(t.length,n.length),r=0;r<e;++r)if(t[r]!=n[r])return r>>1;if(t.length>e||n.length>e)return e}function i(t,n){var r='<table class="mt-output">';r+="<tr>";for(i=0;i<t.length;i+=2){var l=t[i],a=t[i+1];r+='<td class="mt-token"'+(i==2*n?" style='background: pink'":"")+'><span class="cm-'+e(String(l))+'">'+e(a.replace(/ /g,"Â·"))+"</span></td>"}r+="</tr><tr>";for(var i=0;i<t.length;i+=2)r+='<td class="mt-style"><span>'+(t[i]||null)+"</span></td>";return r+="</table>"}var s=/[\w&-_]+/g;test.mode=function(t,e,l,a){var i=n(l);return test((a||e.name)+"_"+t,function(){return r(i.plain,i.tokens,e)})}}();