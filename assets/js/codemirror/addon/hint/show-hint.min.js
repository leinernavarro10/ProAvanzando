!function(){"use strict";function t(t,e,i){this.cm=t,this.getHints=e,this.options=i,this.widget=this.onClose=null}function e(t){return"string"==typeof t?t:t.text}function i(t,e){function i(t,i){var s;s="string"!=typeof i?function(t){return i(t,e)}:o.hasOwnProperty(i)?o[i]:i,n[t]=s}var o={Up:function(){e.moveFocus(-1)},Down:function(){e.moveFocus(1)},PageUp:function(){e.moveFocus(1-e.menuSize(),!0)},PageDown:function(){e.moveFocus(e.menuSize()-1,!0)},Home:function(){e.setFocus(0)},End:function(){e.setFocus(e.length-1)},Enter:e.pick,Tab:e.pick,Esc:e.close},n=t.customKeys?{}:o;if(t.customKeys)for(var s in t.customKeys)t.customKeys.hasOwnProperty(s)&&i(s,t.customKeys[s]);if(t.extraKeys)for(var s in t.extraKeys)t.extraKeys.hasOwnProperty(s)&&i(s,t.extraKeys[s]);return n}function o(t,e){for(;e&&e!=t;){if("LI"===e.nodeName.toUpperCase()&&e.parentNode==t)return e;e=e.parentNode}}function n(t,n){this.completion=t,this.data=n;var c=this,l=t.cm,h=t.options,a=this.hints=document.createElement("ul");a.className="CodeMirror-hints",this.selectedHint=h.getDefaultSelection?h.getDefaultSelection(l,h,n):0;for(var u=n.list,f=0;f<u.length;++f){var d=a.appendChild(document.createElement("li")),m=u[f],p=s+(f!=this.selectedHint?"":" "+r);null!=m.className&&(p=m.className+" "+p),d.className=p,m.render?m.render(d,n,m):d.appendChild(document.createTextNode(m.displayText||e(m))),d.hintId=f}var g=l.cursorCoords(!1!==h.alignWithWord?n.from:null),v=g.left,C=g.bottom,w=!0;a.style.left=v+"px",a.style.top=C+"px";var y=window.innerWidth||Math.max(document.body.offsetWidth,document.documentElement.offsetWidth),H=window.innerHeight||Math.max(document.body.offsetHeight,document.documentElement.offsetHeight);(h.container||document.body).appendChild(a);var M=a.getBoundingClientRect(),A=M.right-y,T=M.bottom-H;if(A>0&&(M.right-M.left>y&&(a.style.width=y-5+"px",A-=M.right-M.left-y),a.style.left=(v=g.left-A)+"px"),T>0){var k=M.bottom-M.top;M.top-(g.bottom-g.top)-k>0?(T=k+(g.bottom-g.top),w=!1):k>H&&(a.style.height=H-5+"px",T-=k-H),a.style.top=(C=g.bottom-T)+"px"}if(l.addKeyMap(this.keyMap=i(h,{moveFocus:function(t,e){c.changeActive(c.selectedHint+t,e)},setFocus:function(t){c.changeActive(t)},menuSize:function(){return c.screenAmount()},length:u.length,close:function(){t.close()},pick:function(){c.pick()}})),!1!==h.closeOnUnfocus){var x;l.on("blur",this.onBlur=function(){x=setTimeout(function(){t.close()},100)}),l.on("focus",this.onFocus=function(){clearTimeout(x)})}var b=l.getScrollInfo();return l.on("scroll",this.onScroll=function(){var e=l.getScrollInfo(),i=l.getWrapperElement().getBoundingClientRect(),o=C+b.top-e.top,n=o-(window.pageYOffset||(document.documentElement||document.body).scrollTop);if(w||(n+=a.offsetHeight),n<=i.top||n>=i.bottom)return t.close();a.style.top=o+"px",a.style.left=v+b.left-e.left+"px"}),CodeMirror.on(a,"dblclick",function(t){var e=o(a,t.target||t.srcElement);e&&null!=e.hintId&&(c.changeActive(e.hintId),c.pick())}),CodeMirror.on(a,"click",function(t){var e=o(a,t.target||t.srcElement);e&&null!=e.hintId&&(c.changeActive(e.hintId),h.completeOnSingleClick&&c.pick())}),CodeMirror.on(a,"mousedown",function(){setTimeout(function(){l.focus()},20)}),CodeMirror.signal(n,"select",u[0],a.firstChild),!0}var s="CodeMirror-hint",r="CodeMirror-hint-active";CodeMirror.showHint=function(e,i,o){if(!e.somethingSelected()){if(null==i){if(o&&o.async)return;i=CodeMirror.hint.auto}e.state.completionActive&&e.state.completionActive.close();var n=e.state.completionActive=new t(e,i,o||{});if(CodeMirror.signal(e,"startCompletion",e),!n.options.async)return n.showHints(i(e,n.options));i(e,function(t){n.showHints(t)},n.options)}},t.prototype={close:function(){this.active()&&(this.cm.state.completionActive=null,this.widget&&this.widget.close(),this.onClose&&this.onClose(),CodeMirror.signal(this.cm,"endCompletion",this.cm))},active:function(){return this.cm.state.completionActive==this},pick:function(t,i){var o=t.list[i];o.hint?o.hint(this.cm,t,o):this.cm.replaceRange(e(o),t.from,t.to),CodeMirror.signal(t,"pick",o),this.close()},showHints:function(t){if(!t||!t.list.length||!this.active())return this.close();0!=this.options.completeSingle&&1==t.list.length?this.pick(t,0):this.showWidget(t)},showWidget:function(t){function e(){c||(c=!0,h.close(),h.cm.off("cursorActivity",r),t&&CodeMirror.signal(t,"close"))}function i(){c||(CodeMirror.signal(t,"update"),h.options.async?h.getHints(h.cm,o,h.options):o(h.getHints(h.cm,h.options)))}function o(i){if(t=i,!c)return t&&t.list.length?void(h.widget=new n(h,t)):e()}function s(){l&&(m(l),l=0)}function r(){s();var t=h.cm.getCursor(),e=h.cm.getLine(t.line);t.line!=u.line||e.length-t.ch!=f-u.ch||t.ch<u.ch||h.cm.somethingSelected()||t.ch&&a.test(e.charAt(t.ch-1))?h.close():(l=d(i),h.widget&&h.widget.close())}this.widget=new n(this,t),CodeMirror.signal(t,"shown");var c,l=0,h=this,a=this.options.closeCharacters||/[\s()\[\]{};:>,]/,u=this.cm.getCursor(),f=this.cm.getLine(u.line).length,d=window.requestAnimationFrame||function(t){return setTimeout(t,1e3/60)},m=window.cancelAnimationFrame||clearTimeout;this.cm.on("cursorActivity",r),this.onClose=e}},n.prototype={close:function(){if(this.completion.widget==this){this.completion.widget=null,this.hints.parentNode.removeChild(this.hints),this.completion.cm.removeKeyMap(this.keyMap);var t=this.completion.cm;!1!==this.completion.options.closeOnUnfocus&&(t.off("blur",this.onBlur),t.off("focus",this.onFocus)),t.off("scroll",this.onScroll)}},pick:function(){this.completion.pick(this.data,this.selectedHint)},changeActive:function(t,e){if(t>=this.data.list.length?t=e?this.data.list.length-1:0:t<0&&(t=e?0:this.data.list.length-1),this.selectedHint!=t){var i=this.hints.childNodes[this.selectedHint];i.className=i.className.replace(" "+r,""),(i=this.hints.childNodes[this.selectedHint=t]).className+=" "+r,i.offsetTop<this.hints.scrollTop?this.hints.scrollTop=i.offsetTop-3:i.offsetTop+i.offsetHeight>this.hints.scrollTop+this.hints.clientHeight&&(this.hints.scrollTop=i.offsetTop+i.offsetHeight-this.hints.clientHeight+3),CodeMirror.signal(this.data,"select",this.data.list[this.selectedHint],i)}},screenAmount:function(){return Math.floor(this.hints.clientHeight/this.hints.firstChild.offsetHeight)||1}},CodeMirror.registerHelper("hint","auto",function(t,e){var i=t.getHelpers(t.getCursor(),"hint");if(i.length)for(var o=0;o<i.length;o++){var n=i[o](t,e);if(n&&n.list.length)return n}else{var s=t.getHelper(t.getCursor(),"hintWords");if(s)return CodeMirror.hint.fromList(t,{words:s})}}),CodeMirror.registerHelper("hint","fromList",function(t,e){for(var i=t.getCursor(),o=t.getTokenAt(i),n=[],s=0;s<e.words.length;s++){var r=e.words[s];r.slice(0,o.string.length)==o.string&&n.push(r)}if(n.length)return{list:n,from:CodeMirror.Pos(i.line,o.start),to:CodeMirror.Pos(i.line,o.end)}}),CodeMirror.commands.autocomplete=CodeMirror.showHint}();