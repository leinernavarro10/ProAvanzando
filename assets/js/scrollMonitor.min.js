!function(t){if("undefined"!=typeof define&&define.amd)define(["jquery"],t);else if("undefined"!=typeof module&&module.exports){var i=require("jquery");module.exports=t(i)}else window.scrollMonitor=t(jQuery)}(function(t){function i(){return window.innerHeight||document.documentElement.clientHeight}function o(){if(l.viewportTop=r.scrollTop(),l.viewportBottom=l.viewportTop+l.viewportHeight,l.documentHeight=a.height(),l.documentHeight!==I){for(y=p.length;y--;)p[y].recalculateLocation();I=l.documentHeight}}function e(){l.viewportHeight=i(),o(),h()}function s(){clearTimeout(H),H=setTimeout(e,100)}function h(){for(B=p.length;B--;)p[B].update();for(B=p.length;B--;)p[B].triggerCallbacks()}function n(i,o){function e(t){if(0!==t.length)for(I=t.length;I--;)(y=t[I]).callback.call(s,k),y.isOne&&t.splice(I,1)}var s=this;this.watchItem=i,this.offsets=o?o===+o?{top:o,bottom:o}:t.extend({},g,o):g,this.callbacks={};for(var h=0,n=V.length;h<n;h++)s.callbacks[V[h]]=[];this.locked=!1;var c,r,a,p,I,y;this.triggerCallbacks=function(){switch(this.isInViewport&&!c&&e(this.callbacks[u]),this.isFullyInViewport&&!r&&e(this.callbacks[f]),this.isAboveViewport!==a&&this.isBelowViewport!==p&&(e(this.callbacks[w]),r||this.isFullyInViewport||(e(this.callbacks[f]),e(this.callbacks[b])),c||this.isInViewport||(e(this.callbacks[u]),e(this.callbacks[m]))),!this.isFullyInViewport&&r&&e(this.callbacks[b]),!this.isInViewport&&c&&e(this.callbacks[m]),this.isInViewport!==c&&e(this.callbacks[w]),!0){case c!==this.isInViewport:case r!==this.isFullyInViewport:case a!==this.isAboveViewport:case p!==this.isBelowViewport:e(this.callbacks[v])}c=this.isInViewport,r=this.isFullyInViewport,a=this.isAboveViewport,p=this.isBelowViewport},this.recalculateLocation=function(){if(!this.locked){var i=this.top,o=this.bottom;if(this.watchItem.nodeName){var s=this.watchItem.style.display;"none"===s&&(this.watchItem.style.display="");var h=t(this.watchItem).offset();this.top=h.top,this.bottom=h.top+this.watchItem.offsetHeight,"none"===s&&(this.watchItem.style.display=s)}else this.watchItem===+this.watchItem?this.watchItem>0?this.top=this.bottom=this.watchItem:this.top=this.bottom=l.documentHeight-this.watchItem:(this.top=this.watchItem.top,this.bottom=this.watchItem.bottom);this.top-=this.offsets.top,this.bottom+=this.offsets.bottom,this.height=this.bottom-this.top,void 0===i&&void 0===o||this.top===i&&this.bottom===o||e(this.callbacks[d])}},this.recalculateLocation(),this.update(),c=this.isInViewport,r=this.isFullyInViewport,a=this.isAboveViewport,p=this.isBelowViewport}function c(t){k=t,o(),h()}var l={},r=t(window),a=t(document),p=[],w="visibilityChange",u="enterViewport",f="fullyEnterViewport",m="exitViewport",b="partiallyExitViewport",d="locationChange",v="stateChange",V=[w,u,f,m,b,d,v],g={top:0,bottom:0};l.viewportTop,l.viewportBottom,l.documentHeight,l.viewportHeight=i();var I,k,y,H,B;n.prototype={on:function(t,i,o){switch(!0){case t===w&&!this.isInViewport&&this.isAboveViewport:case t===u&&this.isInViewport:case t===f&&this.isFullyInViewport:case t===m&&this.isAboveViewport&&!this.isInViewport:case t===b&&this.isAboveViewport:if(i(),o)return}if(!this.callbacks[t])throw new Error("Tried to add a scroll monitor listener of type "+t+". Your options are: "+V.join(", "));this.callbacks[t].push({callback:i,isOne:o})},off:function(t,i){if(!this.callbacks[t])throw new Error("Tried to remove a scroll monitor listener of type "+t+". Your options are: "+V.join(", "));for(var o,e=0;o=this.callbacks[t][e];e++)if(o.callback===i){this.callbacks[t].splice(e,1);break}},one:function(t,i){this.on(t,i,!0)},recalculateSize:function(){this.height=this.watchItem.offsetHeight+this.offsets.top+this.offsets.bottom,this.bottom=this.top+this.height},update:function(){this.isAboveViewport=this.top<l.viewportTop,this.isBelowViewport=this.bottom>l.viewportBottom,this.isInViewport=this.top<=l.viewportBottom&&this.bottom>=l.viewportTop,this.isFullyInViewport=this.top>=l.viewportTop&&this.bottom<=l.viewportBottom||this.isAboveViewport&&this.isBelowViewport},destroy:function(){var t=p.indexOf(this),i=this;p.splice(t,1);for(var o=0,e=V.length;o<e;o++)i.callbacks[V[o]].length=0},lock:function(){this.locked=!0},unlock:function(){this.locked=!1}};for(var T=0,A=V.length;T<A;T++){var F=V[T];n.prototype[F]=function(t){return function(i,o){this.on.call(this,t,i,o)}}(F)}try{o()}catch(i){t(o)}return r.on("scroll",c),r.on("resize",s),l.beget=l.create=function(i,o){"string"==typeof i&&(i=t(i)[0]),i instanceof t&&(i=i[0]);var e=new n(i,o);return p.push(e),e.update(),e},l.update=function(){k=null,o(),h()},l.recalculateLocations=function(){l.documentHeight=0,l.update()},l});