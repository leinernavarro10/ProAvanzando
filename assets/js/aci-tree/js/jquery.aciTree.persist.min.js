!function(e,t,s){var i={persist:null},n={__extend:function(){e.extend(this._private,{selectTimeout:null,focusTimeout:null,openTimeout:null}),this._super()},_initPersist:function(){this._instance.jQuery.bind("acitree"+this._private.nameSpace,function(e,t,s,i,n){if("ui.persist"!=n.uid)switch(i){case"init":t._persistRestore();break;case"selected":case"deselected":t._persistLater("selected");break;case"focus":case"blur":t._persistLater("focused");break;case"opened":case"closed":t._persistLater("opened")}})},_initHook:function(){this.extPersist()&&this._initPersist(),this._super()},_persistLater:function(e){switch(e){case"selected":t.clearTimeout(this._private.selectTimeout),this._private.selectTimeout=t.setTimeout(this.proxy(function(){this._persistSelected()}),250);break;case"focused":t.clearTimeout(this._private.focusTimeout),this._private.focusTimeout=t.setTimeout(this.proxy(function(){this._persistFocused()}),250);break;case"opened":t.clearTimeout(this._private.openTimeout),this._private.openTimeout=t.setTimeout(this.proxy(function(){this._persistOpened()}),250)}},_persistRestoreX:function(){var t=new this._queue(this,this._instance.options.queue),s=e.jStorage.get("aciTree_"+this._instance.options.persist+"_opened");if(s instanceof Array)for(var i in s)!function(e){t.push(function(t){this.searchPath(null,{success:function(e){this.open(e,{uid:"ui.persist",success:t,fail:t})},fail:t,path:e.split(";"),load:!0})})}(s[i]);if(this.extSelectable&&this.extSelectable()){var n=e.jStorage.get("aciTree_"+this._instance.options.persist+"_selected");if(n instanceof Array)for(var i in n)if(function(e){t.push(function(t){this.searchPath(null,{success:function(e){this.select(e,{uid:"ui.persist",success:function(){t()},fail:t,focus:!1})},fail:t,path:e.split(";")})})}(n[i]),!this._instance.options.multiSelectable)break;var c=e.jStorage.get("aciTree_"+this._instance.options.persist+"_focused");if(c instanceof Array)for(var i in c)!function(e){t.push(function(t){this.searchPath(null,{success:function(e){this.focus(e,{uid:"ui.persist",success:function(e){this.setVisible(e,{center:!0}),t()},fail:t})},fail:t,path:e.split(";")})})}(c[i])}},_persistRestore:function(){var t=new this._queue(this,this._instance.options.queue),s=new this._task(t,function(s){if(this.extSelectable&&this.extSelectable()){var i=e.jStorage.get("aciTree_"+this._instance.options.persist+"_selected");if(i instanceof Array)for(var n in i)if(function(e){t.push(function(t){this.searchPath(null,{success:function(e){this.select(e,{uid:"ui.persist",success:function(){t()},fail:t,focus:!1})},fail:t,path:e.split(";")})})}(i[n]),!this._instance.options.multiSelectable)break;var c=e.jStorage.get("aciTree_"+this._instance.options.persist+"_focused");if(c instanceof Array)for(var n in c)!function(e){t.push(function(t){this.searchPath(null,{success:function(e){this.focus(e,{uid:"ui.persist",success:function(e){this.setVisible(e,{center:!0}),t()},fail:t})},fail:t,path:e.split(";")})})}(c[n])}s()}),i=e.jStorage.get("aciTree_"+this._instance.options.persist+"_opened");if(i instanceof Array)for(var n in i)!function(e){s.push(function(t){this.searchPath(null,{success:function(e){this.open(e,{uid:"ui.persist",success:t,fail:t})},fail:t,path:e.split(";"),load:!0})})}(i[n])},_persistSelected:function(){if(this.extSelectable&&this.extSelectable()){var t=[];this.selected().each(this.proxy(function(s){var i=e(s),n=this.pathId(i);n.push(this.getId(i)),t.push(n.join(";"))},!0)),e.jStorage.set("aciTree_"+this._instance.options.persist+"_selected",t)}},_persistFocused:function(){if(this.extSelectable&&this.extSelectable()){var t=[];this.focused().each(this.proxy(function(s){var i=e(s),n=this.pathId(i);n.push(this.getId(i)),t.push(n.join(";"))},!0)),e.jStorage.set("aciTree_"+this._instance.options.persist+"_focused",t)}},_persistOpened:function(){var t=[];this.inodes(this.children(null,!0),!0).each(this.proxy(function(s){var i=e(s);if(this.isOpenPath(i)){var n=this.pathId(i);n.push(this.getId(i)),t.push(n.join(";"))}},!0)),e.jStorage.set("aciTree_"+this._instance.options.persist+"_opened",t)},isPersist:function(){if(this.extPersist()){if(e.jStorage.get("aciTree_"+this._instance.options.persist+"_selected")instanceof Array)return!0;if(e.jStorage.get("aciTree_"+this._instance.options.persist+"_focused")instanceof Array)return!0;if(e.jStorage.get("aciTree_"+this._instance.options.persist+"_opened")instanceof Array)return!0}return!1},unpersist:function(){this.extPersist()&&(e.jStorage.deleteKey("aciTree_"+this._instance.options.persist+"_selected"),e.jStorage.deleteKey("aciTree_"+this._instance.options.persist+"_focused"),e.jStorage.deleteKey("aciTree_"+this._instance.options.persist+"_opened"))},extPersist:function(){return this._instance.options.persist},option:function(e,t){var s=this.extPersist();this._super(e,t),this.extPersist()!=s&&(s?this._donePersist():this._initPersist())},_donePersist:function(){this._instance.jQuery.unbind(this._private.nameSpace)},_destroyHook:function(e){e&&this._donePersist(),this._super(e)}};aciPluginClass.plugins.aciTree=aciPluginClass.plugins.aciTree.extend(n,"aciTreePersist"),aciPluginClass.defaults("aciTree",i)}(jQuery,this);