!function(i,e,t){var s={radio:!1,radioChain:!0,radioBreak:!0,radioClick:!1},a={_radioInit:function(){this._instance.jQuery.bind("acitree"+this._private.nameSpace,function(i,e,t,s,a){switch(s){case"loaded":t&&e._radioLoad(t)}}).bind("keydown"+this._private.nameSpace,this.proxy(function(i){switch(i.which){case 32:if(this.extSelectable&&this.extSelectable()&&!i.ctrlKey){var e=this.focused();this.hasRadio(e)&&this.isEnabled(e)&&(this.isChecked(e)||this.check(e),i.stopImmediatePropagation(),i.preventDefault())}}})).on("click"+this._private.nameSpace,".aciTreeItem",this.proxy(function(e){if(!this._instance.options.radioClick||i(e.target).is(".aciTreeCheck")){var t=this.itemFrom(e.target);!this.hasRadio(t)||!this.isEnabled(t)||this.extSelectable&&this.extSelectable()&&(e.ctrlKey||e.shiftKey)||(this.isChecked(t)||this.check(t),e.preventDefault())}}))},_initHook:function(){this.extRadio()&&this._radioInit(),this._super()},_itemHook:function(i,e,t,s){this.extRadio()&&(this.extCheckbox&&this.hasCheckbox(e)||!t.radio&&(void 0!==t.radio||this.extCheckbox&&this.extCheckbox())||this._radioDOM.add(e,t)),this._super(i,e,t,s)},_radioDOM:{add:function(i,e){i.attr("aria-checked",!!e.checked).addClass("aciTreeRadio"+(e.checked?" aciTreeChecked":"")).children(".aciTreeLine").find(".aciTreeText").wrap("<label></label>").before('<span class="aciTreeCheck" />')},remove:function(i){var e=i.removeAttr("aria-checked").removeClass("aciTreeRadio aciTreeChecked").children(".aciTreeLine").find("label");e.length&&(e.find("*").not(".aciTreeText").remove(),e.find(".aciTreeText").unwrap())},check:function(i,e){i.attr("aria-checked",e).toggleClass("aciTreeChecked",e)}},_radioLoad:function(i){this._instance.options.radioChain&&this.hasRadio(i)&&(this.isChecked(i)?this.radios(this.children(i,!1,!0),!0).length||this._radioUpdate(i,!0):this._radioUpdate(i))},_radioChildren:function(e){if(this._instance.options.radioBreak){var t=[],s=this.proxy(function(e){this.children(e,!1,!0).each(this.proxy(function(e){var a=i(e);this.hasRadio(a)&&(t.push(e),s(a))},!0))});return s(e),i(t)}var a=this.children(e,!0,!0);return this.radios(a)},_radioLevel:function(e){var t=[];return e.each(this.proxy(function(e){var s=i(e);this.children(s,!1,!0).each(this.proxy(function(e){var s=i(e);this._instance.options.radioBreak&&!this.hasRadio(s)||t.push(e)},!0))},!0)),i(t)},_radioUpdate:function(e,t){var s=this.proxy(function(e){var t=this.siblings(e,!0);this._radioDOM.check(this.radios(t),!1),t.each(this.proxy(function(e){var t=i(e);this._instance.options.radioBreak&&!this.hasRadio(t)||this._radioDOM.check(this._radioChildren(t),!1)},!0))});t&&s(e);var a=this.proxy(function(i){var e=this._radioLevel(i),t=this.radios(e);if(t.length){var h=this.radios(e,!0);h.length?(h=h.first(),this._radioDOM.check(h,!0),s(h),a(h)):(h=t.first(),this._radioDOM.check(h,!0),s(h),a(h))}else e.length&&a(e)});t?a(e):this._radioDOM.check(this._radioChildren(e),!1);var h=this.proxy(function(i){var e=this.parent(i);e.length&&(this.hasRadio(e)?(t&&s(e),this._radioDOM.check(e,t),h(e)):this._instance.options.radioBreak||(t&&s(e),h(e)))});void 0!==t&&h(e)},hasRadio:function(i){return i&&i.hasClass("aciTreeRadio")},addRadio:function(i,e){if(e=this._options(e,"radioadded","addradiofail","wasradio",i),this.isItem(i)){if(!this._trigger(i,"beforeaddradio",e))return void this._fail(i,e);if(this.hasRadio(i))this._notify(i,e);else{var t=function(){this._radioDOM.add(i,{}),this._success(i,e)};this.extCheckbox&&this.hasCheckbox(i)?this.removeCheckbox(i,this._inner(e,{success:t,fail:e.fail})):t.apply(this)}}else this._fail(i,e)},removeRadio:function(i,e){if(e=this._options(e,"radioremoved","removeradiofail","notradio",i),this.isItem(i)){if(!this._trigger(i,"beforeremoveradio",e))return void this._fail(i,e);this.hasRadio(i)?(this._radioDOM.remove(i),this._success(i,e)):this._notify(i,e)}else this._fail(i,e)},isChecked:function(i){return this.hasRadio(i)?i.hasClass("aciTreeChecked"):!!this._super&&this._super(i)},check:function(i,e){if(this.extRadio&&this.hasRadio(i)){if(e=this._options(e,"checked","checkfail","waschecked",i),!this._trigger(i,"beforecheck",e))return void this._fail(i,e);this.isChecked(i)?this._notify(i,e):(this._radioDOM.check(i,!0),this._instance.options.radioChain&&this._radioUpdate(i,!0),this._success(i,e))}else this._super?this._super(i,e):(this._trigger(i,"checkfail",e),this._fail(i,e))},uncheck:function(i,e){if(this.extRadio&&this.hasRadio(i)){if(e=this._options(e,"unchecked","uncheckfail","notchecked",i),!this._trigger(i,"beforeuncheck",e))return void this._fail(i,e);this.isChecked(i)?(this._radioDOM.check(i,!1),this._instance.options.radioChain&&this._radioUpdate(i,!1),this._success(i,e)):this._notify(i,e)}else this._super?this._super(i,e):(this._trigger(i,"uncheckfail",e),this._fail(i,e))},radios:function(i,e){var t=i.filter(".aciTreeRadio");return void 0!==e?e?t.filter(".aciTreeChecked"):t.not(".aciTreeChecked"):t},_serialize:function(i,e){var t=this._super(i,e);return t&&this.extRadio()&&(t.hasOwnProperty("radio")?(t.radio=this.hasRadio(i),t.checked=this.isChecked(i)):this.hasRadio(i)&&(this.extCheckbox&&this.extCheckbox()&&(t.radio=!0),t.checked=this.isChecked(i))),t},serialize:function(e,t,s){if("radio"==t){var a="",h=this.children(e,!0,!0);return this.radios(h,!0).each(this.proxy(function(e){var h=i(e);a+=s?s.call(this,h,t,this.getId(h)):this._instance.options.serialize.call(this,h,t,this.getId(h))},!0)),a}return this._super(e,t,s)},extRadio:function(){return this._instance.options.radio},option:function(i,e){this.wasInit()&&!this.isLocked()&&"radio"==i&&e!=this.extRadio()&&(e?this._radioInit():this._radioDone()),this._super(i,e)},_radioDone:function(e){this._instance.jQuery.unbind(this._private.nameSpace),this._instance.jQuery.off(this._private.nameSpace,".aciTreeItem"),e||this.radios(this.children(null,!0,!0)).each(this.proxy(function(e){this.removeRadio(i(e))},!0))},_destroyHook:function(i){i&&this._radioDone(!0),this._super(i)}};aciPluginClass.plugins.aciTree=aciPluginClass.plugins.aciTree.extend(a,"aciTreeRadio"),aciPluginClass.defaults("aciTree",s)}(jQuery);