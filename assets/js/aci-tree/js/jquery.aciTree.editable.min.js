!function(e,t,i){var s={editable:!1,editDelay:250},a={__extend:function(){e.extend(this._private,{editTimestamp:null}),this._super()},_editableInit:function(){this._instance.jQuery.bind("acitree"+this._private.nameSpace,function(e,t,i,s,a){switch(s){case"blurred":(i=t.edited()).length&&t.endEdit();break;case"deselected":t.isEdited(i)&&t.endEdit()}}).bind("click"+this._private.nameSpace,this.proxy(function(){this.edited().length&&this.endEdit()})).bind("keydown"+this._private.nameSpace,this.proxy(function(e){switch(e.which){case 113:if(this.extSelectable&&this.extSelectable()){var t=this.focused();t.length&&!this.isEdited(t)&&this.isEnabled(t)&&(this.edit(t),e.preventDefault())}}})).on("mousedown"+this._private.nameSpace,".aciTreeItem",this.proxy(function(t){e(t.target).is(".aciTreeItem,.aciTreeText")&&(this._private.editTimestamp=e.now())})).on("mouseup"+this._private.nameSpace,".aciTreeItem",this.proxy(function(t){if(e(t.target).is(".aciTreeItem,.aciTreeText")){var i=e.now()-this._private.editTimestamp;if(i>this._instance.options.editDelay&&i<4*this._instance.options.editDelay){var s=this.itemFrom(t.target);(!this.extSelectable||!this.extSelectable()||this.isFocused(s)&&1==this.selected().length)&&this.isEnabled(s)&&this.edit(s)}}})).on("keydown"+this._private.nameSpace,"input[type=text]",this.proxy(function(e){switch(e.which){case 13:this.itemFrom(e.target).focus(),this.endEdit(),e.stopPropagation();break;case 27:this.itemFrom(e.target).focus(),this.endEdit({save:!1}),e.stopPropagation(),e.preventDefault();break;case 38:case 40:case 37:case 39:case 33:case 34:case 36:case 35:case 32:case 107:case 109:case 106:e.stopPropagation()}})).on("blur"+this._private.nameSpace,"input[type=text]",this.proxy(function(){this.extSelectable&&this.extSelectable()||this.endEdit()})).on("click"+this._private.nameSpace+" dblclick"+this._private.nameSpace,"input[type=text]",function(e){e.stopPropagation()})},_initHook:function(){this.extEditable()&&this._editableInit(),this._super()},_editableDOM:{add:function(e){var t=e.addClass("aciTreeEdited").children(".aciTreeLine");t.find(".aciTreeText").html('<input id="aciTree-editable-tree-item" type="text" value="" style="-webkit-user-select:text;-moz-user-select:text;-ms-user-select:text;-o-user-select:text;user-select:text" />'),t.find("label").attr("for","aciTree-editable-tree-item"),this._editableDOM.get(e).val(this.getLabel(e))},remove:function(e,t){var i=e.removeClass("aciTreeEdited").children(".aciTreeLine");i.find(".aciTreeText").html(this.getLabel(e)),i.find("label").removeAttr("for")},get:function(t){return t?t.children(".aciTreeLine").find("input[type=text]"):e([])}},edited:function(){return this._instance.jQuery.find(".aciTreeEdited")},isEdited:function(e){return e&&e.hasClass("aciTreeEdited")},_focusEdit:function(e){var t=this._editableDOM.get(e).focus().trigger("click").get(0);if(t)if("number"==typeof t.selectionStart)t.selectionStart=t.selectionEnd=t.value.length;else if(void 0!==t.createTextRange){var i=t.createTextRange();i.collapse(!1),i.select()}},setLabel:function(e,t){this.extEditable()&&this.isEdited(e)||this._super(e,t)},edit:function(e,t){if(t=this._options(t,"edit","editfail","wasedit",e),this.extEditable()&&this.isItem(e)){if(!this._trigger(e,"beforeedit",t))return void this._fail(e,t);var i=this.edited();if(i.length){if(i.get(0)==e.get(0))return void this._notify(e,t);this._editableDOM.remove.call(this,i),this._trigger(i,"endedit",t)}this._editableDOM.add.call(this,e),this._focusEdit(e),this._success(e,t)}else this._fail(e,t)},endEdit:function(e){var t=this.edited();if(e=this._options(e,"edited","endeditfail","endedit",t),this.extEditable()&&this.isItem(t)){if(!this._trigger(t,"beforeendedit",e))return void this._fail(t,e);var i=this._editableDOM.get(t).val();this._editableDOM.remove.call(this,t),void 0===e.save||e.save?(this.setLabel(t,{label:i}),this._success(t,e)):this._notify(t,e)}else this._fail(t,e)},extEditable:function(){return this._instance.options.editable},option:function(e,t){this.wasInit()&&!this.isLocked()&&"editable"==e&&t!=this.extEditable()&&(t?this._editableInit():this._editableDone()),this._super(e,t)},_editableDone:function(){this._instance.jQuery.unbind(this._private.nameSpace),this._instance.jQuery.off(this._private.nameSpace,".aciTreeItem"),this._instance.jQuery.off(this._private.nameSpace,"input[type=text]"),this.edited().length&&this.endEdit()},_destroyHook:function(e){e&&this._editableDone(),this._super(e)}};aciPluginClass.plugins.aciTree=aciPluginClass.plugins.aciTree.extend(a,"aciTreeEditable"),aciPluginClass.defaults("aciTree",s)}(jQuery);