!function(i,e,t){var s={ajax:{url:null,dataType:"json"},dataSource:null,rootData:null,queue:{async:4,interval:50,delay:20},loaderDelay:500,expand:!1,collapse:!1,unique:!1,empty:!1,show:{props:{height:"show"},duration:"medium",easing:"linear"},animateRoot:!0,hide:{props:{height:"hide"},duration:"medium",easing:"linear"},view:{duration:"medium",easing:"linear"},ajaxHook:function(i,e){e.url+=i?this.getId(i):""},itemHook:function(i,e,t,s){},serialize:function(i,e,t){return"object"==typeof e?t:"|"+t}},n={__extend:function(){i.extend(this._instance,{queue:new this._queue(this,this._instance.options.queue)}),i.extend(this._private,{locked:!1,itemClone:{},loaderHide:null,loaderInterval:null,delayBusy:0})},init:function(i){if(i=this._options(i),this.wasInit())return this._trigger(null,"wasinit",i),void this._fail(null,i);if(this.isLocked())return this._trigger(null,"locked",i),void this._fail(null,i);if(!this._trigger(null,"beforeinit",i))return this._trigger(null,"initfail",i),void this._fail(null,i);this._private.locked=!0,this._instance.jQuery.addClass("aciTree"+this._instance.index).attr("role","tree").on("click"+this._instance.nameSpace,".aciTreeButton",this.proxy(function(i){var e=this.itemFrom(i.target);this.isBusy(e)||this.toggle(e,{collapse:this._instance.options.collapse,expand:this._instance.options.expand,unique:this._instance.options.unique})})).on("mouseenter"+this._instance.nameSpace+" mouseleave"+this._instance.nameSpace,".aciTreePush",function(i){var e=i.target;a.hasClass(e,"aciTreePush")||(e=a.parentByClass(e,"aciTreePush")),a.toggleClass(e,"aciTreeHover","mouseenter"==i.type)}).on("mouseenter"+this._instance.nameSpace+" mouseleave"+this._instance.nameSpace,".aciTreeLine",function(i){var e=i.target;a.hasClass(e,"aciTreeLine")||(e=a.parentByClass(e,"aciTreeLine")),a.toggleClass(e,"aciTreeHover","mouseenter"==i.type)}),this._initHook();var e=this.proxy(function(){this._super(),this._private.locked=!1,this._trigger(null,"init",i),this._success(null,i)}),t=this.proxy(function(){this._super(),this._private.locked=!1,this._trigger(null,"initfail",i),this._fail(null,i)});this._instance.options.rootData?this.loadFrom(null,this._inner(i,{success:e,fail:t,itemData:this._instance.options.rootData})):this._instance.options.ajax.url?this.ajaxLoad(null,this._inner(i,{success:e,fail:t})):e.apply(this)},_initHook:function(){},isLocked:function(){return this._private.locked},_format:function(i,t){if(!(t instanceof Array))return i;for(var s,n,a,r=i.split(/(%[0-9]+)/gm),o="",h=!1,l=new e.RegExp("^%[0-9]+$"),c=0;c<r.length;c++)if(s=r[c],a=s.length){if(!h&&l.test(s)){if((n=e.parseInt(s.substr(1))-1)>=0&&n<t.length){o+=t[n];continue}}else h=!1,"%"==s.substr(a-1)&&("%%"!=s.substr(a-2)&&(h=!0),s=s.substr(0,a-1));o+=s}return o},_coreDOM:{leaf:function(i){a.addRemoveListClass(i.toArray(),"aciTreeLeaf",["aciTreeInode","aciTreeInodeMaybe","aciTreeOpen"],function(i){i.removeAttribute("aria-expanded")})},inode:function(i,e){a.addRemoveListClass(i.toArray(),e?"aciTreeInode":"aciTreeInodeMaybe","aciTreeLeaf",function(i){i.setAttribute("aria-expanded",!1)})},toggle:function(i,e){a.toggleListClass(i.toArray(),"aciTreeOpen",e,function(i){i.setAttribute("aria-expanded",e)})},oddEven:function(i,e){for(var t=i.toArray(),s=0;s<t.length;s++)a.addRemoveClass(t[s],e?"aciTreeOdd":"aciTreeEven",e?"aciTreeEven":"aciTreeOdd"),e=!e}},_queue:function(i,t){var s=!1,n=[],a=[],r=0,o=0,h=0,l=0,c=function(){if(s)return void l--;var u=(new e.Date).getTime();if(h>u)return void l--;var d,f=!1;r<2*t.async&&(d=n.shift()),!d&&o<t.async&&(d=a.shift(),f=!0),d&&(f?(o++,d.call(i,function(){o--}),l<40&&(l++,c())):(r++,d.call(i,function(){u-h>t.interval&&(h=u+t.delay),r--,l<40&&(l++,c())}))),l--},u=[],d=function(){for(var i=0;i<4;i++)u[i]=e.setInterval(function(){l<20&&(l++,c())},10)},f=function(){for(var i=0;i<u.length;i++)e.clearInterval(u[i])};d(),this.init=function(){return this.destroy(),d(),this},this.push=function(i,e){return s||(e?a.push(i):n.push(i)),this},this.busy=function(){return 0!=r||0!=o||0!=n.length||0!=a.length},this.destroy=function(){return s=!0,f(),n=[],a=[],r=0,o=0,h=0,l=0,s=!1,this}},_task:function(i,e){var t=0,s=!1;this.push=function(n,a){t++,i.push(function(i){var a=this;n.call(this,function(){--t<1&&!s?(s=!0,e.call(a,i)):i()})},a)}},_options:function(e,t,s,n,a){var r=i.extend({uid:"ui",success:null,fail:null,notify:null,expand:this._instance.options.expand,collapse:this._instance.options.collapse,unique:this._instance.options.unique,unanimated:!1,itemData:{}},e),o=t?"string"==typeof t?function(){this._trigger(a,t,r)}:t:null,h=s?"string"==typeof s?function(){this._trigger(a,s,r)}:s:null,l=n?"string"==typeof n?function(){this._trigger(a,n,r)}:n:null;return o&&(e&&e.success?r.success=function(){o.apply(this,arguments),e.success.apply(this,arguments)}:r.success=o),h&&(e&&e.fail?r.fail=function(){h.apply(this,arguments),e.fail.apply(this,arguments)}:r.fail=h),l?e&&e.notify?r.notify=function(){l.apply(this,arguments),e.notify.apply(this,arguments)}:!r.notify&&e&&e.success?r.notify=function(){l.apply(this,arguments),e.success.apply(this,arguments)}:r.notify=l:!r.notify&&e&&e.success&&(r.notify=e.success),r},_inner:function(e,t){return i.extend({},e,{success:null,fail:null,notify:null},t)},_trigger:function(e,t,s){var n=i.Event("acitree");return s||(s=this._options()),this._instance.jQuery.trigger(n,[this,e,t,s]),!n.isDefaultPrevented()},_success:function(i,e){e&&e.success&&e.success.call(this,i,e)},_fail:function(i,e){e&&e.fail&&e.fail.call(this,i,e)},_notify:function(i,e){e&&e.notify&&e.notify.call(this,i,e)},_delayBusy:function(i,t){if(this._private.delayBusy<10&&this.isBusy(i))return this._private.delayBusy++,void e.setTimeout(this.proxy(function(){this._delayBusy.call(this,i,t),this._private.delayBusy--}),10);t.apply(this)},_dataSource:function(i){var e=this._instance.options.dataSource;if(e){var t=this.itemData(i);if(t&&t.source&&e[t.source])return e[t.source];var s;do{if(s=this.parent(i),(t=this.itemData(s))&&t.source&&e[t.source])return e[t.source]}while(s.length)}return this._instance.options.ajax},ajaxLoad:function(e,t){if(e&&this.isBusy(e))return void this._delayBusy(e,function(){this.ajaxLoad(e,t)});t=this._options(t,function(){this._loading(e),this._trigger(e,"loaded",t)},function(){this._loading(e),this._trigger(e,"loadfail",t)},function(){this._loading(e),this._trigger(e,"wasloaded",t)}),!e||this.isInode(e)?this._instance.queue.push(function(s){if(!this._trigger(e,"beforeload",t))return this._fail(e,t),void s();if(this._loading(e,!0),this.wasLoad(e))return this._notify(e,t),void s();var n=i.extend({},this._dataSource(e));this._instance.options.ajaxHook.call(this,e,n),n.success=this.proxy(function(i){if(i&&i instanceof Array&&i.length){n=function(){this.wasLoad(e)?(this._notify(e,t),s()):this._createBranch(e,this._inner(t,{success:function(){this._success(e,t),s()},fail:function(){this._fail(e,t),s()},itemData:i}))};!e||this.isInode(e)?n.apply(this):this.setInode(e,this._inner(t,{success:n,fail:t.fail}))}else{var n=function(){this._fail(e,t),s()};!e||this.isLeaf(e)?n.apply(this):this.setLeaf(e,this._inner(t,{success:n,fail:n}))}}),n.error=this.proxy(function(){this._fail(e,t),s()}),i.ajax(n)},!0):this._fail(e,t)},loadFrom:function(i,e){if(i&&this.isBusy(i))return void this._delayBusy(i,function(){this.loadFrom(i,e)});if(e=this._options(e,function(){this._loading(i),this._trigger(i,"loaded",e)},function(){this._loading(i),this._trigger(i,"loadfail",e)},function(){this._loading(i),this._trigger(i,"wasloaded",e)}),!i||this.isInode(i)){if(!this._trigger(i,"beforeload",e))return void this._fail(i,e);if(this._loading(i,!0),this.wasLoad(i))return void this._notify(i,e);if(e.itemData&&e.itemData instanceof Array&&e.itemData.length){var t=function(){this.wasLoad(i)?this._notify(i,e):this._createBranch(i,e)};!i||this.isInode(i)?t.apply(this):this.setInode(i,this._inner(e,{success:t,fail:e.fail}))}else!i||this.isLeaf(i)?this._fail(i,e):this.setLeaf(i,this._inner(e,{success:e.fail,fail:e.fail}))}else this._fail(i,e)},unload:function(e,t){if(t=this._options(t,function(){this._loading(e),this._trigger(e,"unloaded",t)},function(){this._loading(e),this._trigger(e,"unloadfail",t)},function(){this._loading(e),this._trigger(e,"notloaded",t)}),!e||this.isInode(e)){if(!this._trigger(e,"beforeunload",t))return void this._fail(e,t);if(this._loading(e,!0),!this.wasLoad(e))return void this._notify(e,t);var s=!1,n=this.children(e,!0,!0);if(n.each(this.proxy(function(e){var n=i(e);if(this.isInode(n)){if(this.isOpen(n)&&!this._trigger(n,"beforeclose",t))return s=!0,!1;if(this.wasLoad(n)&&!this._trigger(n,"beforeunload",t))return s=!0,!1}if(!this._trigger(n,"beforeremove",t))return s=!0,!1},!0)),s)return void this._fail(e,t);var a=function(){n.each(this.proxy(function(e){var s=i(e);this.isInode(s)&&(this.isOpen(s)&&this._trigger(s,"closed",t),this.wasLoad(s)&&this._trigger(s,"unloaded",t)),this._trigger(s,"removed",t)},!0))};e?this.isOpen(e)?this.close(e,this._inner(t,{success:function(){a.call(this),this._removeContainer(e),this._success(e,t)},fail:t.fail})):(a.call(this),this._removeContainer(e),this._success(e,t)):this._animate(e,!1,!this._instance.options.animateRoot||t.unanimated,function(){a.call(this),this._removeContainer(),this._success(e,t)})}else this._fail(e,t)},remove:function(i,e){if(this.isItem(i))if(this.hasSiblings(i)){if(e=this._options(e,function(){this.isOpenPath(i)&&(a.removeClass(i[0],"aciTreeVisible"),this._setOddEven(i)),this._trigger(i,"removed",e)},"removefail",null,i),!this._trigger(i,"beforeremove",e))return void this._fail(i,e);this.wasLoad(i)?this.unload(i,this._inner(e,{success:function(){this._success(i,e),this._removeItem(i)},fail:e.fail})):(this._success(i,e),this._removeItem(i))}else{var t=this.parent(i);t.length?this.setLeaf(t,e):this.unload(null,e)}else this._trigger(i,"removefail",e),this._fail(i,e)},_openChildren:function(e,t){if(t.expand){var s=this._instance.queue;this.inodes(this.children(e)).each(function(){var e=i(this);s.push(function(i){this.open(e,this._inner(t)),i()})}),s.push(function(i){this._success(e,t),i()})}else this._success(e,t)},_openItem:function(i,e){e.unanimated||this.isVisible(i)||(e.unanimated=!0),e.unique&&(this.closeOthers(i),e.unique=!1),this._coreDOM.toggle(i,!0),this._setOddEvenChildren(i),this._animate(i,!0,e.unanimated,function(){this._openChildren(i,e)})},open:function(i,e){if(e=this._options(e,function(){this.isOpenPath(i)&&(this._updateVisible(i),this._setOddEven(i)),this._trigger(i,"opened",e)},"openfail","wasopened",i),this.isInode(i)){if(!this._trigger(i,"beforeopen",e))return void this._fail(i,e);this.isOpen(i)?(e.success=e.notify,this._openChildren(i,e)):this.wasLoad(i)?this._openItem(i,e):this.ajaxLoad(i,this._inner(e,{success:function(){this._openItem(i,e)},fail:e.fail}))}else this._fail(i,e)},_closeChildren:function(e,t){if(this._instance.options.empty)t.unanimated=!0,this.unload(e,t);else if(t.collapse){var s=this._instance.queue;this.inodes(this.children(e)).each(function(){var e=i(this);s.push(function(i){this.close(e,this._inner(t,{unanimated:!0})),i()})}),s.push(function(i){this._success(e,t),i()})}else this._success(e,t)},_closeItem:function(i,e){e.unanimated||this.isVisible(i)||(e.unanimated=!0),this._coreDOM.toggle(i,!1),this._animate(i,!1,e.unanimated,function(){this._closeChildren(i,e)})},close:function(i,e){if(e=this._options(e,function(){this.isOpenPath(i)&&(this._updateVisible(i),this._setOddEven(i)),this._trigger(i,"closed",e)},"closefail","wasclosed",i),this.isInode(i)){if(!this._trigger(i,"beforeclose",e))return void this._fail(i,e);this.isOpen(i)?this._closeItem(i,e):this.wasLoad(i)?(e.success=e.notify,this._closeChildren(i,e)):this._notify(i,e)}else this._fail(i,e)},_updateVisible:function(e){this.isOpenPath(e)?this.isHidden(e)||(a.addClass(e[0],"aciTreeVisible"),this.isOpen(e)?a.children(e[0],!1,this.proxy(function(e){a.hasClass(e,"aciTreeVisible")||this._updateVisible(i(e))})):a.children(e[0],!0,function(i){return!!a.removeClass(i,"aciTreeVisible")||null})):a.removeClass(e[0],"aciTreeVisible")&&a.children(e[0],!0,function(i){return!!a.removeClass(i,"aciTreeVisible")||null})},closeOthers:function(e,t){if(t=this._options(t),this.isItem(e)){var s=this._instance.queue,n=e.add(this.path(e)).add(this.children(e,!0));this.inodes(this.children(null,!0,!0),!0).not(n).each(function(){var e=i(this);s.push(function(i){this.close(e,this._inner(t)),i()})}),s.push(function(i){this._success(e,t),i()})}else this._fail(e,t)},toggle:function(i,e){if(e=this._options(e,"toggled","togglefail",null,i),this.isInode(i)){if(!this._trigger(i,"beforetoggle",e))return void this._fail(i,e);this.isOpen(i)?this.close(i,e):this.open(i,e)}else this._fail(i,e)},path:function(e,t){if(e){for(var s=e[0],n=[];s=a.parent(s);)n.push(s);return i(t?n:n.reverse())}return i([])},isVisible:function(e,t){if(e&&this.isOpenPath(e)){var s=this._instance.jQuery[0].getBoundingClientRect(),n=a.childrenByClass(e[0],"aciTreeItem"),r=n.getBoundingClientRect(),o=i(n).outerHeight(!0),h=t?this._instance.jQuery.innerHeight()/2:0;return!(r.bottom-o<s.top+h||r.top+o>s.bottom-h)}return!1},openPath:function(e,t){if(t=this._options(t),this.isItem(e)){var s=this._instance.queue;this.inodes(this.path(e),!1).each(function(){var e=i(this);s.push(function(i){this.open(e,this._inner(t)),i()})}),s.push(function(i){this._success(e,t),i()})}else this._fail(e,t)},isOpenPath:function(i){var e=this.parent(i);return!e.length||this.isOpen(e)&&a.hasClass(e[0],"aciTreeVisible")},_speedFraction:function(i,e,t){if(t<e&&e){var s=parseInt(i);if(isNaN(s))switch(i){case"slow":s=600;break;case"medium":s=400;break;case"fast":s=200;break;default:return i}return s*t/e}return i},setVisible:function(e,t){if(t=this._options(t,"visible","visiblefail","wasvisible",e),this.isItem(e)){if(!this._trigger(e,"beforevisible",t))return void this._fail(e,t);if(this.isVisible(e))return void this._notify(e,t);var s=function(){var s=this._instance.jQuery[0].getBoundingClientRect(),n=a.childrenByClass(e[0],"aciTreeItem"),r=n.getBoundingClientRect(),o=i(n).outerHeight(!0),h=t.center?this._instance.jQuery.innerHeight()/2:0;if(r.bottom-o<s.top+h){l=s.top+h-r.bottom+o;!t.unanimated&&this._instance.options.view?this._instance.jQuery.stop(!0).animate({scrollTop:this._instance.jQuery.scrollTop()-l},{duration:this._speedFraction(this._instance.options.view.duration,s.bottom-s.top,l),easing:this._instance.options.view.easing,complete:this.proxy(function(){this._success(e,t)})}):(this._instance.jQuery.stop(!0).get(0).scrollTop=this._instance.jQuery.scrollTop()-l,this._success(e,t))}else if(r.top+o>s.bottom-h){var l=r.top-s.bottom+h+o;!t.unanimated&&this._instance.options.view?this._instance.jQuery.stop(!0).animate({scrollTop:this._instance.jQuery.scrollTop()+l},{duration:this._speedFraction(this._instance.options.view.duration,s.bottom-s.top,l),easing:this._instance.options.view.easing,complete:this.proxy(function(){this._success(e,t)})}):(this._instance.jQuery.stop(!0).get(0).scrollTop=this._instance.jQuery.scrollTop()+l,this._success(e,t))}else this._success(e,t)};this.hasParent(e)?this.openPath(e,this._inner(t,{success:s,fail:t.fail})):s.apply(this)}else this._fail(e,t)},hasParent:function(i){return this.parent(i).length>0},parent:function(e){return i(e?a.parent(e[0]):[])},topParent:function(i){return this.path(i).eq(0)},_createBranch:function(i,e){var t=0,s=function(i){for(var e,n=0;n<i.length;n++)(e=i[n]).branch&&e.branch instanceof Array&&e.branch.length&&s(e.branch);t++};s(e.itemData);var n=0,r=this.proxy(function(){++n>=t&&this._success(i,e)}),o=this.proxy(function(i,t){i&&a.addRemoveClass(i[0],"aciTreeInode","aciTreeInodeMaybe"),this.append(i,this._inner(e,{success:function(i,e){for(var t,s=0;s<e.itemData.length;s++)(t=e.itemData[s]).branch&&t.branch instanceof Array&&t.branch.length&&o(e.items.eq(s),t.branch),t.open&&this.open(e.items.eq(s),this._inner(e,{itemData:null,items:null}));r()},fail:e.fail,itemData:t}))});o(i,e.itemData)},_getFirstLast:function(e){return e||(e=this._instance.jQuery),i(a.withAnyClass(a.children(e[0]),["aciTreeFirst","aciTreeLast"]))},_setFirstLast:function(i,e){e&&a.removeListClass(e.toArray(),["aciTreeFirst","aciTreeLast"]),this.hasChildren(i)&&(a.addClass(this.first(i)[0],"aciTreeFirst"),a.addClass(this.last(i)[0],"aciTreeLast"))},_setOddEven:function(t){var s;this._instance.jQuery[0].getElementsByClassName?(s=this._instance.jQuery[0].getElementsByClassName("aciTreeVisible"),s=s?e.Array.prototype.slice.call(s):[]):s=i(a.children(this._instance.jQuery[0],!0,function(i){return!!this.hasClass(i,"aciTreeVisible")||null}));var n=!0;if(s.length){var r=0;if(t&&(t.each(function(){if(s.indexOf){var i=s.indexOf(this);-1!=i&&(r=e.Math.min(i,r))}else for(var t=0;t<s.length;t++)if(s[t]===this){r=e.Math.min(t,r);break}}),r=e.Math.max(r-1,0)),r>0){var o=s[r];a.hasClass(o,"aciTreOdd")&&(n=!1),s=s.slice(r+1)}}this._coreDOM.oddEven(i(s),n)},_setOddEvenChildren:function(i){var e=a.hasClass(i[0],"aciTreeOdd"),t=this.children(i);this._coreDOM.oddEven(t,!e)},_itemHook:function(i,e,t,s){this._instance.options.itemHook&&this._instance.options.itemHook.apply(this,arguments)},_createItem:function(t,s){if(this._private.itemClone[s]){for(var n=(r=this._private.itemClone[s].cloneNode(!0)).firstChild,a=0;a<s;a++)n=n.firstChild;_=(n=n.firstChild.lastChild.firstChild).nextSibling}else{var r=e.document.createElement("LI");r.setAttribute("tabindex",-1),r.setAttribute("role","treeitem"),r.setAttribute("aria-selected",!1);var o=e.document.createElement("DIV");r.appendChild(o),o.className="aciTreeLine";for(var h,l=o,a=0;a<s;a++)h=e.document.createElement("DIV"),l.appendChild(h),h.className="aciTreeBranch aciTreeLevel"+a,l=h;var c=e.document.createElement("DIV");l.appendChild(c),c.className="aciTreeEntry";var u=e.document.createElement("SPAN");c.appendChild(u),u.className="aciTreeButton";var d=e.document.createElement("SPAN");u.appendChild(d),d.className="aciTreePush",d.appendChild(e.document.createElement("SPAN"));var f=e.document.createElement("SPAN");c.appendChild(f),f.className="aciTreeItem";n=e.document.createElement("SPAN");f.appendChild(n);var _=e.document.createElement("SPAN");f.appendChild(_),_.className="aciTreeText",this._private.itemClone[s]=r.cloneNode(!0)}r.className="aciTreeLi"+(t.inode||null===t.inode?t.inode||t.branch&&t.branch.length?" aciTreeInode":" aciTreeInodeMaybe":" aciTreeLeaf")+" aciTreeLevel"+s+(t.disabled?" aciTreeDisabled":""),r.setAttribute("aria-level",s+1),t.icon?t.icon instanceof Array?(n.className="aciTreeIcon "+t.icon[0],n.style.backgroundPosition=t.icon[1]+"px "+t.icon[2]+"px"):n.className="aciTreeIcon "+t.icon:n.parentNode.removeChild(n),_.innerHTML=t.label;var p=i(r);return p.data("itemData"+this._instance.nameSpace,i.extend({},t,{branch:t.branch&&t.branch.length})),p},_removeItem:function(i){var e=this.parent(i);i.remove(),this._setFirstLast(e.length?e:null)},_createItems:function(t,s,n,a,r,o){var h=[],l=e.document.createDocumentFragment(),c=new this._task(this._instance.queue,function(e){(h=i(h)).length&&(t?t[0].appendChild(l):s?s[0].parentNode.insertBefore(l,s[0]):n&&n[0].parentNode.insertBefore(l,n[0].nextSibling)),o.call(this,h),e()});if(a){this._loader(!0);var u;if(t?u=this.itemFrom(t):s?u=this.parent(s):n&&(u=this.parent(n)),a instanceof Array)for(var d=0;d<a.length;d++)!function(i){c.push(function(e){var t=this._createItem(i,r);this._itemHook(u,t,i,r),l.appendChild(t[0]),h.push(t[0]),e()})}(a[d]);else c.push(function(i){var e=this._createItem(a,r);this._itemHook(u,e,a,r),l.appendChild(e[0]),h.push(e[0]),i()})}c.push(function(i){i()})},_createContainer:function(t){t||(t=this._instance.jQuery);var s=a.container(t[0]);return s||((s=e.document.createElement("UL")).setAttribute("role","group"),s.className="aciTreeUl",s.style.display="none",t[0].appendChild(s)),i(s)},_removeContainer:function(i){i||(i=this._instance.jQuery);var e=a.container(i[0]);e.parentNode.removeChild(e)},append:function(e,t){if(t=this._options(t,"appended","appendfail",null,e),e)if(this.isInode(e)){if(!this._trigger(e,"beforeappend",t))return void this._fail(e,t);var s=this._createContainer(e),n=this.last(e);this._createItems(s,null,null,t.itemData,this.level(e)+1,function(r){r.length?(a.addRemoveClass(e[0],"aciTreeInode","aciTreeInodeMaybe"),this._setFirstLast(e,n),this.isHidden(e)?a.addListClass(r.toArray(),"aciTreeHidden"):this.isOpenPath(e)&&this.isOpen(e)&&(a.addListClass(r.toArray(),"aciTreeVisible"),this._setOddEven(r.first())),r.each(this.proxy(function(e){this._trigger(i(e),"added",t)},!0))):this.hasChildren(e,!0)||s.remove(),t.items=r,this._success(e,t)})}else this._fail(e,t);else{if(!this._trigger(e,"beforeappend",t))return void this._fail(e,t);var s=this._createContainer(),n=this.last();this._createItems(s,null,null,t.itemData,0,function(r){r.length?(this._setFirstLast(null,n),a.addListClass(r.toArray(),"aciTreeVisible"),this._setOddEven(),r.each(this.proxy(function(e){this._trigger(i(e),"added",t)},!0)),this._animate(null,!0,!this._instance.options.animateRoot||t.unanimated)):this.hasChildren(null,!0)||s.remove(),t.items=r,this._success(e,t)})}},before:function(e,t){if(t=this._options(t,"before","beforefail",null,e),this.isItem(e)){if(!this._trigger(e,"beforebefore",t))return void this._fail(e,t);var s=this.prev(e);this._createItems(null,e,null,t.itemData,this.level(e),function(n){if(n.length){s.length||(a.removeClass(e[0],"aciTreeFirst"),a.addClass(n.first()[0],"aciTreeFirst"));var r=this.parent(e);r.length&&this.isHidden(r)?a.addListClass(n.toArray(),"aciTreeHidden"):this.isOpenPath(e)&&(a.addListClass(n.toArray(),"aciTreeVisible"),this._setOddEven(n.first())),n.each(this.proxy(function(e){this._trigger(i(e),"added",t)},!0))}t.items=n,this._success(e,t)})}else this._fail(e,t)},after:function(e,t){if(t=this._options(t,"after","afterfail",null,e),this.isItem(e)){if(!this._trigger(e,"beforeafter",t))return void this._fail(e,t);var s=this.next(e);this._createItems(null,null,e,t.itemData,this.level(e),function(n){if(n.length){s.length||(a.removeClass(e[0],"aciTreeLast"),a.addClass(n.last()[0],"aciTreeLast"));var r=this.parent(e);r.length&&this.isHidden(r)?a.addListClass(n.toArray(),"aciTreeHidden"):this.isOpenPath(e)&&(a.addListClass(n.toArray(),"aciTreeVisible"),this._setOddEven(n.first())),n.each(this.proxy(function(e){this._trigger(i(e),"added",t)},!0))}t.items=n,this._success(e,t)})}else this._fail(e,t)},itemFrom:function(e){if(e){var t=i(e);return i(t[0]===this._instance.jQuery[0]?[]:a.parentFrom(t[0]))}return i([])},children:function(e,t,s){return i(a.children(e?e[0]:this._instance.jQuery[0],t,s?null:function(i){return!this.hasClass(i,"aciTreeHidden")||null}))},visible:function(e,t){var s=a.withClass(e.toArray(),"aciTreeVisible");if(t){for(var n=[],r=0;r<s.length;r++)this.isVisible(i(s[r]))&&n.push(s[r]);return i(n)}return i(s)},inodes:function(e,t){return i(void 0!==t?t?a.withClass(e.toArray(),"aciTreeOpen"):a.withAnyClass(e.toArray(),["aciTreeInode","aciTreeInodeMaybe"],"aciTreeOpen"):a.withAnyClass(e.toArray(),["aciTreeInode","aciTreeInodeMaybe"]))},leaves:function(e){return i(a.withClass(e.toArray(),"aciTreeLeaf"))},isInode:function(i){return i&&a.hasAnyClass(i[0],["aciTreeInode","aciTreeInodeMaybe"])},isLeaf:function(i){return i&&a.hasClass(i[0],"aciTreeLeaf")},wasLoad:function(i){return i?null!==a.container(i[0]):null!==a.container(this._instance.jQuery[0])},setInode:function(i,e){if(e=this._options(e,"inodeset","inodefail","wasinode",i),this.isItem(i)){if(!this._trigger(i,"beforeinode",e))return void this._fail(i,e);this.isLeaf(i)?(this._coreDOM.inode(i,!0),this._success(i,e)):this._notify(i,e)}else this._fail(i,e)},setLeaf:function(i,e){if(e=this._options(e,"leafset","leaffail","wasleaf",i),this.isItem(i)){if(!this._trigger(i,"beforeleaf",e))return void this._fail(i,e);if(this.isInode(i)){var t=function(){this._coreDOM.leaf(i),this._success(i,e)};this.wasLoad(i)?this.unload(i,this._inner(e,{success:t,fail:e.fail})):t.apply(this)}else this._notify(i,e)}else this._fail(i,e)},addIcon:function(i,e){if(e=this._options(e,"iconadded","addiconfail","wasicon",i),this.isItem(i)){if(!this._trigger(i,"beforeaddicon",e))return void this._fail(i,e);var t=this.itemData(i);e.oldIcon=t.icon;var s=i.children(".aciTreeLine").find(".aciTreeItem"),n=s.children(".aciTreeIcon");n.length&&t.icon&&e.icon.toString()==t.icon.toString()?this._notify(i,e):(e.icon instanceof Array?n.length?n.attr("class","aciTreeIcon "+e.icon[0]).css("background-position",e.icon[1]+"px "+e.icon[2]+"px"):s.prepend('<div class="aciTreeIcon '+e.icon[0]+'" style="background-position:'+e.icon[1]+"px "+e.icon[2]+'px"></div>'):n.length?n.attr("class","aciTreeIcon "+e.icon):s.prepend('<div class="aciTreeIcon '+e.icon+'"></div>'),t.icon=e.icon,this._success(i,e))}else this._fail(i,e)},removeIcon:function(i,e){if(e=this._options(e,"iconremoved","removeiconfail","noticon",i),this.isItem(i)){if(!this._trigger(i,"beforeremoveicon",e))return void this._fail(i,e);var t=this.itemData(i);e.oldIcon=t.icon;var s=i.children(".aciTreeLine").find(".aciTreeItem").children(".aciTreeIcon");s.length?(s.remove(),t.icon=null,this._success(i,e)):this._notify(i,e)}else this._fail(i,e)},hasIcon:function(i){return!!this.getIcon(i)},getIcon:function(i){var e=this.itemData(i);return e?e.icon:null},setLabel:function(i,e){if(e=this._options(e,"labelset","labelfail","waslabel",i),this.isItem(i)){if(!this._trigger(i,"beforelabel",e))return void this._fail(i,e);var t=this.itemData(i);e.oldLabel=t.label,e.label==e.oldLabel?this._notify(i,e):(i.children(".aciTreeLine").find(".aciTreeText").html(e.label),t.label=e.label,this._success(i,e))}else this._fail(i,e)},disable:function(i,e){if(e=this._options(e,"disabled","disablefail","wasdisabled",i),this.isItem(i)){if(!this._trigger(i,"beforedisable",e))return void this._fail(i,e);this.isDisabled(i)?this._notify(i,e):(i.addClass("aciTreeDisabled"),this._success(i,e))}else this._fail(i,e)},isDisabled:function(i){return i&&i.hasClass("aciTreeDisabled")},isDisabledPath:function(i){return this.path(i).is(".aciTreeDisabled")},disabled:function(i){return i.filter(".aciTreeDisabled")},enable:function(i,e){if(e=this._options(e,"enabled","enablefail","wasenabled",i),this.isItem(i)){if(!this._trigger(i,"beforeenable",e))return void this._fail(i,e);this.isDisabled(i)?(i.removeClass("aciTreeDisabled"),this._success(i,e)):this._notify(i,e)}else this._fail(i,e)},isEnabled:function(i){return i&&!i.hasClass("aciTreeDisabled")},isEnabledPath:function(i){return!this.path(i).is(".aciTreeDisabled")},enabled:function(i){return i.not(".aciTreeDisabled")},hide:function(i,e){if(e=this._options(e,"hidden","hidefail","washidden",i),this.isItem(i)){if(!this._trigger(i,"beforehide",e))return void this._fail(i,e);if(this.isHidden(i))this._notify(i,e);else{i.removeClass("aciTreeVisible").addClass("aciTreeHidden"),this.children(i,!0).removeClass("aciTreeVisible").addClass("aciTreeHidden");var t=this.parent(i);this._setFirstLast(t.length?t:null,i),this._setOddEven(i),this._success(i,e)}}else this._fail(i,e)},isHidden:function(i){return i&&i.hasClass("aciTreeHidden")},isHiddenPath:function(i){var e=this.parent(i);return!!e.length&&e.hasClass("aciTreeHidden")},_updateHidden:function(i){this.isHiddenPath(i)?this.isHidden(i)||(i.addClass("aciTreeHidden"),this._updateVisible(i)):this._updateVisible(i)},hidden:function(i){return i.filter(".aciTreeHidden")},_showHidden:function(e){var t=null;this.path(e).add(e).each(this.proxy(function(e){var s=i(e);this.isHidden(s)&&(s.removeClass("aciTreeHidden"),!this.isOpenPath(s)||t&&!this.isOpen(t)||s.addClass("aciTreeVisible"),this._setFirstLast(t,this._getFirstLast(t))),t=s},!0))},show:function(i,e){if(e=this._options(e,"shown","showfail","wasshown",i),this.isItem(i)){if(!this._trigger(i,"beforeshow",e))return void this._fail(i,e);if(this.isHidden(i)){this._showHidden(i);var t=this.topParent(i);this._setOddEven(t.length?t:i),this._success(i,e)}else this._notify(i,e)}else this._fail(i,e)},isOpen:function(i){return i&&i.hasClass("aciTreeOpen")},isClosed:function(i){return i&&!i.hasClass("aciTreeOpen")},hasChildren:function(i,e){return this.children(i,null,e).length>0},hasSiblings:function(i,e){return this.siblings(i,e).length>0},hasPrev:function(i,e){return this.prev(i,e).length>0},hasNext:function(i,e){return this.next(i,e).length>0},siblings:function(e,t){return e?e.siblings(".aciTreeLi"+(t?"":":not(.aciTreeHidden)")):i([])},prev:function(e,t){return e?t?e.prev(".aciTreeLi"):e.prevAll(".aciTreeLi:not(.aciTreeHidden):first"):i([])},next:function(e,t){return e?t?e.next(".aciTreeLi"):e.nextAll(".aciTreeLi:not(.aciTreeHidden):first"):i([])},level:function(i){var e=-1;if(this.isItem(i))for(;i.hasClass("aciTreeLi");)i=i.parent().parent(),e++;return e},getId:function(i){var e=this.itemData(i);return e?e.id:null},itemData:function(i){return i?i.data("itemData"+this._instance.nameSpace):null},setId:function(i,e){if(e=this._options(e,"idset","idfail","wasid",i),this.isItem(i)){if(!this._trigger(i,"beforeid",e))return void this._fail(i,e);var t=this.itemData(i);e.oldId=t.id,e.id==e.oldId?this._notify(i,e):(t.id=e.id,this._success(i,e))}else this._fail(i,e)},getIndex:function(i){return i?i.parent().children(".aciTreeLi").index(i):null},setIndex:function(i,e){if(e=this._options(e,"indexset","indexfail","wasindex",i),this.isItem(i)){var t=this.getIndex(i),s=this.siblings(i);if(e.index!=t&&!s.length)return void this._fail(i,e);if(!this._trigger(i,"beforeindex",e))return void this._fail(i,e);if(e.oldIndex=t,e.index==t)this._notify(i,e);else{e.index<1?s.first().before(i):e.index>=s.length?s.last().after(i):s.eq(e.index).before(i);var n=this.parent(i);this._setFirstLast(n.length?n:null,i.add([s.get(0),s.get(-1)])),this._setOddEven(n),this._success(i,e)}}else this._fail(i,e)},getLabel:function(i){var e=this.itemData(i);return e?e.label:null},isItem:function(i){return i&&i.hasClass("aciTreeLi")},_animate:function(i,e,t,s){if(i||(i=this._instance.jQuery),!t){var n=e?this._instance.options.show:this._instance.options.hide;if(n){var a=i.children(".aciTreeUl");return void(a.length?a.stop(!0,!0).animate(n.props,{duration:n.duration,easing:n.easing,complete:s?this.proxy(s):null}):s&&s.apply(this))}}i.children(".aciTreeUl").stop(!0,!0).toggle(e),s&&s.apply(this)},first:function(i,e){return i||(i=this._instance.jQuery),i.children(".aciTreeUl").children(".aciTreeLi"+(e?"":":not(.aciTreeHidden)")+":first")},isFirst:function(i,e){if(i){var t=this.parent(i);return this.first(t.length?t:null,e).is(i)}return!1},last:function(i,e){return i||(i=this._instance.jQuery),i.children(".aciTreeUl").children(".aciTreeLi"+(e?"":":not(.aciTreeHidden)")+":last")},isLast:function(i,e){if(i){var t=this.parent(i);return this.last(t.length?t:null,e).is(i)}return!1},isBusy:function(i){return i?a.hasClass(i[0],"aciTreeLoad"):this._instance.queue.busy()},_loading:function(i,e){i?(a.toggleClass(i[0],"aciTreeLoad",e),e?i[0].setAttribute("aria-busy",!0):i[0].removeAttribute("aria-busy")):e&&this._loader(e)},_loader:function(i){(i||this.isBusy())&&(this._private.loaderInterval||(this._private.loaderInterval=e.setInterval(this.proxy(function(){this._loader()}),this._instance.options.loaderDelay)),this._instance.jQuery.addClass("aciTreeLoad"),e.clearTimeout(this._private.loaderHide),this._private.loaderHide=e.setTimeout(this.proxy(function(){this._instance.jQuery.removeClass("aciTreeLoad")}),2*this._instance.options.loaderDelay))},isChildren:function(i,e){return i||(i=this._instance.jQuery),e&&i.has(e).length>0},isImmediateChildren:function(i,e){return i||(i=this._instance.jQuery),e&&i.children(".aciTreeUl").children(".aciTreeLi").is(e)},sameParent:function(i,e){if(i&&e){var t=this.parent(i),s=this.parent(e);return!t.length&&!s.length||t.get(0)==s.get(0)}return!1},sameTopParent:function(i,e){if(i&&e){var t=this.topParent(i),s=this.topParent(e);return!t.length&&!s.length||t.get(0)==s.get(0)}return!1},_serialize:function(e,t){var s=this.itemData(e);return this.isInode(e)?(s.inode=!0,this.wasLoad(e)?(s.hasOwnProperty("open")?s.open=this.isOpen(e):this.isOpen(e)&&(s.open=!0),s.branch=[],this.children(e,!1,!0).each(this.proxy(function(e){var n=this._serialize(i(e),t);(n=t?t.call(this,i(e),{},n):this._instance.options.serialize.call(this,i(e),{},n))&&s.branch.push(n)},!0)),s.branch.length||(s.branch=null)):(s.hasOwnProperty("open")&&(s.open=!1),s.hasOwnProperty("branch")&&(s.branch=null))):(s.hasOwnProperty("inode")&&(s.inode=!1),s.hasOwnProperty("open")&&(s.open=null),s.hasOwnProperty("branch")&&(s.branch=null)),s.hasOwnProperty("disabled")?s.disabled=this.isDisabled(e):this.isDisabled(e)&&(s.disabled=!0),s},serialize:function(e,t,s){if("object"==typeof t){if(e){var n=this._serialize(e,s);return n=s?s.call(this,e,{},n):this._instance.options.serialize.call(this,e,{},n)}var a=[];return this.children(null,!1,!0).each(this.proxy(function(e){var t=this._serialize(i(e),s);(t=s?s.call(this,i(e),{},t):this._instance.options.serialize.call(this,i(e),{},t))&&a.push(t)},!0)),a}return""},destroy:function(i){return i=this._options(i),this.wasInit()?this.isLocked()?(this._trigger(null,"locked",i),void this._fail(null,i)):this._trigger(null,"beforedestroy",i)?(this._private.locked=!0,this._instance.jQuery.addClass("aciTreeLoad").attr("aria-busy",!0),this._instance.queue.destroy(),this._destroyHook(!1),void this.unload(null,this._inner(i,{success:this.proxy(function(){e.clearTimeout(this._private.loaderHide),e.clearInterval(this._private.loaderInterval),this._private.itemClone={},this._destroyHook(!0),this._instance.jQuery.unbind(this._instance.nameSpace).off(this._instance.nameSpace,".aciTreeButton").off(this._instance.nameSpace,".aciTreeLine"),this._instance.jQuery.removeClass("aciTree"+this._instance.index+" aciTreeLoad").removeAttr("role aria-busy"),this._private.locked=!1,this._super(),this._trigger(null,"destroyed",i),this._success(null,i)}),fail:function(){this._instance.jQuery.removeClass("aciTreeLoad"),this._private.locked=!1,this._trigger(null,"destroyfail",i),this._fail(null,i)}}))):(this._trigger(null,"destroyfail",i),void this._fail(null,i)):(this._trigger(null,"notinit",i),void this._fail(null,i))},_destroyHook:function(i){}};aciPluginClass.plugins.aciTree=aciPluginClass.aciPluginUi.extend(n,"aciTreeCore"),aciPluginClass.publish("aciTree",s);var a=aciPluginClass.plugins.aciTree_dom}(jQuery,this);