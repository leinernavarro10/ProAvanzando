!function(a,t,e){var i=function(a,e){var r=t(a);r.data("markdownarea")||(this.element=r,this.options=t.extend({},i.defaults,e),this.init(),this.element.data("markdownarea",this))};t.extend(i.prototype,{init:function(){var a=this,r=i.template;r=(r=r.replace(/\{\:lblPreview\}/g,this.options.lblPreview)).replace(/\{\:lblCodeview\}/g,this.options.lblCodeview),this.markdownarea=t(r),this.content=this.markdownarea.find(".uk-markdownarea-content"),this.toolbar=this.markdownarea.find(".uk-markdownarea-toolbar"),this.preview=this.markdownarea.find(".uk-markdownarea-preview").children().eq(0),this.code=this.markdownarea.find(".uk-markdownarea-code"),this.element.before(this.markdownarea).appendTo(this.code),this.editor=CodeMirror.fromTextArea(this.element[0],this.options.codemirror),this.editor.markdownarea=this,this.editor.on("change",function(){var t=function(){var t=a.editor.getValue();a.originalvalue=String(t),a.currentvalue=String(t),a.element.trigger("markdownarea-before",[a]),marked(a.currentvalue,function(t,e){if(t)throw t;a.preview.html(e),a.element.val(a.currentvalue).trigger("markdownarea-update",[a])})};return t(),e.Utils.debounce(t,200)}()),this._buildtoolbar(),this.fit(),t(window).on("resize",e.Utils.debounce(function(){a.fit()},200));var o=a.preview.parent(),n=this.code.find(".CodeMirror-sizer"),l=this.code.find(".CodeMirror-scroll").on("scroll",e.Utils.debounce(function(){if("tab"!=a.markdownarea.attr("data-mode")){var t=n.height()-l.height(),e=(o[0].scrollHeight-o.height())/t,i=l.scrollTop()*e;o.scrollTop(i)}},10));this.markdownarea.on("click",".uk-markdown-button-markdown, .uk-markdown-button-preview",function(e){e.preventDefault(),"tab"==a.markdownarea.attr("data-mode")&&(a.markdownarea.find(".uk-markdown-button-markdown, .uk-markdown-button-preview").removeClass("uk-active").filter(this).addClass("uk-active"),a.activetab=t(this).hasClass("uk-markdown-button-markdown")?"code":"preview",a.markdownarea.attr("data-active-tab",a.activetab))}),this.preview.parent().css("height",this.code.height())},_buildtoolbar:function(){if(this.options.toolbar&&this.options.toolbar.length){var a=this,e=[];this.options.toolbar.forEach(function(t){if(i.commands[t]){var r=i.commands[t].title?i.commands[t].title:t;e.push('<li><a data-markdownarea-cmd="'+t+'" title="'+r+'" data-uk-tooltip>'+i.commands[t].label+"</a></li>"),i.commands[t].shortcut&&a.registerShortcut(i.commands[t].shortcut,i.commands[t].action)}}),this.toolbar.html(e.join("\n")),this.markdownarea.on("click","a[data-markdownarea-cmd]",function(){var e=t(this).data("markdownareaCmd");!e||!i.commands[e]||a.activetab&&"code"!=a.activetab||i.commands[e].action.apply(a,[a.editor])})}},fit:function(){var a=this.options.mode;"split"==a&&this.markdownarea.width()<this.options.maxsplitsize&&(a="tab"),"tab"==a&&(this.activetab||(this.activetab="code",this.markdownarea.attr("data-active-tab",this.activetab)),this.markdownarea.find(".uk-markdown-button-markdown, .uk-markdown-button-preview").removeClass("uk-active").filter("code"==this.activetab?".uk-markdown-button-markdown":".uk-markdown-button-preview").addClass("uk-active")),this.markdownarea.attr("data-mode",a)},registerShortcut:function(a,e){for(var i=this,r=0,o=(a=t.isArray(a)?a:[a]).length;r<o;r++){var n={};n[a[r]]=function(){e.apply(i,[i.editor])},i.editor.addKeyMap(n)}}}),t.fn.markdownarea=function(a){return this.each(function(){var e=t(this);if(!e.data("markdownarea"))new i(e,a)})};var r=function(a,t){var e=t.getSelection(),i=a.replace("$1",e);t.replaceSelection(i,"end")};i.commands={fullscreen:{title:"Fullscreen",label:'<i class="uk-icon-expand"></i>',action:function(a){a.markdownarea.markdownarea.toggleClass("uk-markdownarea-fullscreen");var t=a.getWrapperElement();if(a.markdownarea.markdownarea.hasClass("uk-markdownarea-fullscreen"))a.state.fullScreenRestore={scrollTop:window.pageYOffset,scrollLeft:window.pageXOffset,width:t.style.width,height:t.style.height},t.style.width="",t.style.height=a.markdownarea.content.height()+"px",document.documentElement.style.overflow="hidden";else{document.documentElement.style.overflow="";var e=a.state.fullScreenRestore;t.style.width=e.width,t.style.height=e.height,window.scrollTo(e.scrollLeft,e.scrollTop)}a.refresh(),a.markdownarea.preview.parent().css("height",a.markdownarea.code.height())}},bold:{title:"Bold",label:'<i class="uk-icon-bold"></i>',shortcut:["Ctrl-B","Cmd-B"],action:function(a){r("**$1**",a)}},italic:{title:"Italic",label:'<i class="uk-icon-italic"></i>',action:function(a){r("*$1*",a)}},strike:{title:"Strikethrough",label:'<i class="uk-icon-strikethrough"></i>',action:function(a){r("~~$1~~",a)}},blockquote:{title:"Blockquote",label:'<i class="uk-icon-quote-right"></i>',action:function(a){r("> $1",a)}},link:{title:"Link",label:'<i class="uk-icon-link"></i>',action:function(a){r("[$1](http://)",a)}},picture:{title:"Picture",label:'<i class="uk-icon-picture-o"></i>',action:function(a){r("![$1](http://)",a)}},listUl:{title:"Unordered List",label:'<i class="uk-icon-list-ul"></i>',action:function(a){r("* $1",a)}},listOl:{title:"Ordered List",label:'<i class="uk-icon-list-ol"></i>',action:function(a){r("1. $1",a)}}},i.defaults={mode:"split",maxsplitsize:1e3,codemirror:{mode:"gfm",tabMode:"indent",tabindex:"2",lineWrapping:!0,dragDrop:!1},toolbar:["bold","italic","strike","link","picture","blockquote","listUl","listOl"],lblPreview:"Preview",lblCodeview:"Markdown"},i.template='<div class="uk-markdownarea uk-clearfix" data-mode="split"><div class="uk-markdownarea-navbar"><ul class="uk-markdownarea-navbar-nav uk-markdownarea-toolbar"></ul><div class="uk-markdownarea-navbar-flip"><ul class="uk-markdownarea-navbar-nav"><li class="uk-markdown-button-markdown"><a>{:lblCodeview}</a></li><li class="uk-markdown-button-preview"><a>{:lblPreview}</a></li><li><a data-markdownarea-cmd="fullscreen"><i class="uk-icon-expand"></i></a></li></ul></div></div><div class="uk-markdownarea-content"><div class="uk-markdownarea-code"></div><div class="uk-markdownarea-preview"><div></div></div></div></div>',e.markdownarea=i,t(function(){marked.setOptions({gfm:!0,tables:!0,breaks:!0,pedantic:!1,sanitize:!1,smartLists:!0,smartypants:!1,langPrefix:"lang-"}),t("textarea[data-uk-markdownarea]").each(function(){var a=t(this);a.data("markdownarea")||new i(a,e.Utils.options(a.attr("data-uk-markdownarea")))})})}(window,jQuery,jQuery.UIkit);